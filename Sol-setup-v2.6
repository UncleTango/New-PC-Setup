@echo off

REM Download and extract fonts
echo Downloading fonts...
powershell -Command "& {Invoke-WebRequest -Uri 'https://github.com/UncleTango/New-PC-Setup/releases/download/v1.0/Fonts.zip' -OutFile 'Fonts.zip'}"
echo Extracting fonts...
powershell -Command "& {Expand-Archive -Path 'Fonts.zip' -DestinationPath 'Fonts'}"

REM Install fonts
echo Installing fonts...
for /f "delims=" %%f in ('dir /b /s "%cd%\Fonts\*.ttf"') do (
    echo Installing "%%~nxf"...
    copy "%%f" "C:\Windows\Fonts\" /y
)

REM Download and install Google Chrome
echo Downloading Google Chrome...
powershell -Command "& {Invoke-WebRequest -Uri 'https://dl.google.com/chrome/install/standalone/GoogleChromeStandaloneEnterprise64.msi' -OutFile 'Chrome.msi'}"
echo Installing Google Chrome...
msiexec /i "Chrome.msi" /qn

REM Download and install Microsoft Teams
echo Downloading Microsoft Teams...
powershell -Command "& {Invoke-WebRequest -Uri 'https://go.microsoft.com/fwlink/p/?linkid=869428' -OutFile 'Teams.exe'}"
echo Installing Microsoft Teams...
start /wait Teams.exe --silent --install

REM Download and install DisplayLink drivers
echo Downloading DisplayLink drivers...
powershell -Command "& {Invoke-WebRequest -Uri 'https://github.com/UncleTango/New-PC-Setup/releases/download/v1.0/DisplayLink.USB.Graphics.Software.for.Windows11.0.M0-EXE.exe' -OutFile 'DisplayLink.exe'}"
echo Installing DisplayLink drivers...
start /wait DisplayLink.exe /silent

REM Download and install printer driver
echo Downloading printer driver...
powershell -Command "& {Invoke-WebRequest -Uri 'https://github.com/UncleTango/New-PC-Setup/releases/download/v1.0/upd-pcl6-x64-6.9.0.24630.exe' -OutFile 'Printer.exe'}"
echo Installing printer driver...
start /wait Printer.exe

REM Cleanup
echo Cleaning up...
del /q Chrome.msi Teams.exe DisplayLink.exe Printer.exe Fonts.zip
rmdir /s /q Fonts

echo Setup complete!
pause
